<html><head><title>scalajs-reaction: Defining Components</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="aappddeevv" /><meta name="description" content="A react integration library for scala.js in the spirit of ReasonReact" /><meta name="og:image" content="/scalajs-reaction/img/poster.png" /><meta name="og:title" content="scalajs-reaction: Defining Components" /><meta name="og:site_name" content="scalajs-reaction" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="A react integration library for scala.js in the spirit of ReasonReact" /><link rel="icon" type="image/png" href="/scalajs-reaction/img/favicon.png" /><meta name="twitter:title" content="scalajs-reaction: Defining Components" /><meta name="twitter:image" content="img/poster.png" /><meta name="twitter:description" content="A react integration library for scala.js in the spirit of ReasonReact" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/scalajs-reaction/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/scalajs-reaction/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/scalajs-reaction/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/scalajs-reaction/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/scalajs-reaction/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/scalajs-reaction/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/scalajs-reaction/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/scalajs-reaction/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/scalajs-reaction/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/scalajs-reaction/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/scalajs-reaction/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/scalajs-reaction/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/scalajs-reaction/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/scalajs-reaction/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/scalajs-reaction/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/scalajs-reaction/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/scalajs-reaction/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/scalajs-reaction/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/scalajs-reaction/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/scalajs-reaction/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/scalajs-reaction/highlight/styles/default.css" /><link rel="stylesheet" href="/scalajs-reaction/css/style.css" /><link rel="stylesheet" href="/scalajs-reaction/css/palette.css" /><link rel="stylesheet" href="/scalajs-reaction/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/scalajs-reaction/" class="brand"><div class="brand-wrapper"><span>scalajs-reaction</span></div></a></li> <li><a href="/scalajs-reaction/docs/index.html" class="">Getting Started</a></li> <li><a href="/scalajs-reaction/docs/creating.html" class=" active ">Defining Components</a></li> <li><a href="/scalajs-reaction/docs/importing.html" class="">Importing from JS</a></li> <li><a href="/scalajs-reaction/docs/exporting.html" class="">Exporting to JS</a></li> <li><a href="/scalajs-reaction/docs/styling.html" class="">Styling Suggestions</a></li> <li><a href="/scalajs-reaction/docs/vdom.html" class="">Virtual DOM</a></li> <li><a href="/scalajs-reaction/docs/router.html" class="">Routing</a></li> <li><a href="/scalajs-reaction/docs/bundling.html" class="">Bundling</a></li> <li><a href="/scalajs-reaction/docs/redux.html" class="">Redux</a></li> <li><a href="/scalajs-reaction/docs/datainterop.html" class="">Data interop</a></li> <li><a href="/scalajs-reaction/docs/facades.html" class="">Widget Facades</a></li> <li><a href="/scalajs-reaction/docs/mixedproject.html" class="">Mixed Projects</a></li> <li><a href="/scalajs-reaction/docs/reactinterop.html" class="">React Interop</a></li> <li><a href="/scalajs-reaction/docs/data-validation.html" class="">Data Validation</a></li> <li><a href="/scalajs-reaction/docs/forms.html" class="">Forms</a></li> <li><a href="/scalajs-reaction/docs/native.html" class="">React Native</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/aappddeevv/scalajs-reaction"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/aappddeevv/scalajs-reaction"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('scalajs-reaction A react integration library for scala.js in the spirit of ReasonReact');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('scalajs-reaction A react integration library for scala.js in the spirit of ReasonReact');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="aappddeevv" data-github-repo="scalajs-reaction"><div class="content-wrapper"><section><h1 id="defining-components">Defining Components</h1>

<p>You use a flavor of the “builder” type pattern to define a component.</p>

<p>In scala.js, a Component is a “data structure” (a javascript object = “record”)
that holds a callback functions. A proxy is setup in javascript that forwards
the react calls to the scala side Component.</p>

<p>To understand the API you can look at the
<a href="https://reasonml.github.io/reason-react">ReasonReact</a> docs to understand the
approach to creating Components in scala.js.</p>

<p>In the next section, we show the stateless component example below. Look at the
demo code for an example of using a reducer component, a component that manages
state. There is no <code class="highlighter-rouge">setState</code> in this facade to manage state, a stateful
component has a buit-in reducer which is essentially a Finite State Machine
(FSM).</p>

<h2 id="stateless-component-approach-1-easiest">Stateless Component Approach #1 (Easiest)</h2>

<p>The easiest approach to creating a component is to use a simple function
definition to define your SFC. There are two type aliases defined, SFC0 (no
args) and SFC1 (1 arg), to create components. These components are equivalent to
defining your component in javascript using a javascript function.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">component1</span> <span class="k">=</span> <span class="nc">SFC0</span><span class="o">{</span> <span class="o">()</span> <span class="k">=&gt;</span> <span class="n">div</span><span class="o">(</span><span class="s">"hello world"</span><span class="o">)</span>
<span class="c1">// or val component1: SFC0 = () =&gt; div("hello world")
</span>
<span class="k">trait</span> <span class="nc">Props</span> <span class="k">extends</span> <span class="n">js</span><span class="o">.</span><span class="nc">Object</span> <span class="o">{</span>
 <span class="k">var</span> <span class="n">p</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">js</span><span class="o">.</span><span class="n">undefined</span>
<span class="o">}</span>

<span class="k">val</span> <span class="n">component2</span> <span class="k">=</span> <span class="nc">SFC1</span><span class="o">[</span><span class="kt">Prop</span><span class="o">]{</span> <span class="n">props</span> <span class="k">=&gt;</span>
  <span class="n">div</span><span class="o">(</span><span class="n">s</span><span class="s">"""hello world ${p.getOrElse("no-arg")"""</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<p>You can use a scala object as the parameter and you will probably want to
memoize the function to ensure that rendering is efficient.</p>

<p>To use these function-based components, they must be converted to a
ReactElement. For SFC1, you can use <code class="highlighter-rouge">yourFunctionComponent.toEl(arg)</code> to
explicitly convert the SFC to a Component for use in other Component
objects. You can also automatically convert a tuple:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span><span class="n">component2</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Props</span> <span class="o">{...})</span>
</code></pre></div></div>

<p>using an automatic conversions (evil!). Like all react components, both SFC0 and
SFC1 must end up with ha call to <code class="highlighter-rouge">ReactJS.createElement(func object, arg)</code> to
become an instance of a Component so we need the “component” and the argument
separated to plug into the standard react API.</p>

<p>A nice benefit of using SFCs is that you can export them easily for use in the
js/ts side of your application assuming the parameter is js friendly.</p>

<h2 id="stateless-component-approach-2">Stateless Component Approach #2</h2>

<p>This approach uses the machinery of the ReasonReact component model.</p>

<p>When we say “defining” a component, we mean that you creating a “template” for a
component instance. When you create a component instance through make or apply,
you are copying that template and providing customizations for rendering,
mounting and other lifecycle actions.</p>

<p>Here is a simple example of defining a component that uses a non-native JS trait
for the props. You can make the props anything you want, individual parameter, a
scala parameter object or a javascript friendly parameter object. You generally
use a javascript friendly parameter object when the component needs to be
exported and used in a javascript environment.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// You can use individual props or a trait or a scala object.
// It's often convenient to use a subtype of js.Object
// non-native JS trait
</span><span class="k">trait</span> <span class="nc">ToDoProps</span> <span class="k">extends</span> <span class="n">js</span><span class="o">.</span><span class="nc">Object</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">todo</span><span class="k">:</span> <span class="kt">ToDo</span> <span class="c1">// has property "name"
</span>  <span class="k">var</span> <span class="n">remove</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=&gt;</span> <span class="nc">Unit</span>
  <span class="c1">// look no children on this props...
</span><span class="o">}</span>

<span class="k">object</span> <span class="nc">ToDo</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">c</span> <span class="k">=</span> <span class="n">statelessComponent</span><span class="o">(</span><span class="s">"ToDo"</span><span class="o">)</span>
  <span class="k">import</span> <span class="nn">c.ops._</span>
  <span class="c1">// def make(todo: ToDo, remove: Unit =&gt; Unit) =
</span>  <span class="c1">// or bundle them together into a trait like below
</span>  <span class="k">def</span> <span class="n">make</span><span class="o">(</span><span class="n">props</span><span class="k">:</span> <span class="kt">ToDoProps</span><span class="o">)</span> <span class="k">=</span>
    <span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="k">new</span> <span class="n">methods</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">render</span> <span class="k">=</span> <span class="n">self</span> <span class="k">=&gt;</span> <span class="o">{</span>
       <span class="n">div</span><span class="o">(</span><span class="k">new</span> <span class="nc">DivProps</span> <span class="o">{</span> <span class="n">style</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">StyleAttr</span><span class="o">(</span><span class="s">"display"</span> <span class="k">=</span> <span class="s">"flex"</span><span class="o">)})(</span>
          <span class="nc">Label</span><span class="o">()(</span><span class="s">"Item:"</span><span class="o">),</span>
          <span class="nc">Label</span><span class="o">()(</span><span class="n">props</span><span class="o">.</span><span class="n">todo</span><span class="o">.</span><span class="n">name</span><span class="o">),</span>
          <span class="nc">DefaultButton</span><span class="o">(</span><span class="k">new</span> <span class="nc">IButtonProps</span><span class="o">{</span>
             <span class="n">text</span> <span class="k">=</span> <span class="s">"Remove"</span>
             <span class="n">onClick</span> <span class="k">=</span> <span class="n">js</span><span class="o">.</span><span class="n">defined</span><span class="o">{(</span><span class="k">_:</span> <span class="kt">ReactEvent</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">props</span><span class="o">.</span><span class="n">remove</span><span class="o">(())}}))</span>
        <span class="o">})</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The parameter <code class="highlighter-rouge">ToDoProps</code> was set as a <code class="highlighter-rouge">js.Object</code> trait so it is easier to
interface into the reactjs world but you could have just as easily used a
parameter list and listed each parameter individually.</p>

<p>You need to use a <code class="highlighter-rouge">val</code> to define <code class="highlighter-rouge">render</code>. Render is required for all
components so the <code class="highlighter-rouge">methods</code> that you are creating forces you to define the
render method with a val. The val is standard scala syntax–you need to define
<code class="highlighter-rouge">val</code> when you instantiate the trait.</p>

<p>Some methods are not required, such as <code class="highlighter-rouge">willMount</code>. The definition for
<code class="highlighter-rouge">willMount</code> would look like:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">willMount</span> <span class="k">=</span> <span class="n">js</span><span class="o">.</span><span class="n">defined</span><span class="o">({</span> <span class="n">self</span> <span class="k">=&gt;</span> 
  <span class="o">})</span>
</code></pre></div></div>

<p>Since <code class="highlighter-rouge">willMount</code> is optional, it is defined as a var and defaults to
<code class="highlighter-rouge">js.undefined</code>. The <code class="highlighter-rouge">js.defined</code> is needed because scala.js cannot work trough
two levels of implicits so <code class="highlighter-rouge">js.defined()</code> helps with type inference. If you
already use scala.js you are probably used to this.</p>

<p>If you define a stateful component, you are required to define, using <code class="highlighter-rouge">val</code>,
<code class="highlighter-rouge">reducer</code> and <code class="highlighter-rouge">initialState</code> in the same way you defined <code class="highlighter-rouge">render</code>. You do not
need to define the parameter types although can if desired.</p>

<p>You can pass in children via your ToDoProps or just add them to the make call,
if you need children. Here’s an example where they are passed in as a
<code class="highlighter-rouge">js.Array[]</code>.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="n">make</span><span class="o">(</span><span class="n">props</span><span class="k">:</span> <span class="kt">ToDoProps</span><span class="o">,</span> <span class="n">children</span><span class="k">:</span> <span class="kt">js.Array</span><span class="o">[</span><span class="kt">ReactNode</span><span class="o">])</span> <span class="k">=</span>
  <span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="k">new</span> <span class="n">methods</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">render</span> <span class="k">=</span> <span class="n">self</span> <span class="k">=&gt;</span> <span class="o">{</span>
       <span class="n">children</span>
     <span class="o">})}</span>
</code></pre></div></div>

<p>Or you can use the scala spread <code class="highlighter-rouge">param: Param, children: ReactNode*) = </code>.</p>

<p>For stateless components with only a render method, you can make the definition
even shorter:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">object</span> <span class="nc">MyComponent</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">c</span> <span class="k">=</span> <span class="n">statelessComponent</span><span class="o">(</span><span class="s">"MyComponent"</span><span class="o">)</span>
  <span class="k">import</span> <span class="nn">c.ops._</span>
  
  <span class="k">def</span> <span class="n">make</span><span class="o">(</span><span class="n">arg</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> 
    <span class="n">render</span> <span class="o">{</span> <span class="n">self</span> <span class="k">=&gt;</span>
        <span class="s">"something renderable"</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p>This shortcut works because <code class="highlighter-rouge">c.ops._</code> imports a method that attaches itself to
<code class="highlighter-rouge">c</code> and calls <code class="highlighter-rouge">c.copy(new methods { ... })</code> for you under the covers. If you
want to use any other methods though you’ll have to default back to the more
verbose copy approach.</p>

<h2 id="stateful-components">Stateful Components</h2>

<p>There are a few different types of components:</p>

<ul>
  <li>stateless</li>
  <li>stateless with retained props</li>
  <li>reducer (stateful)</li>
  <li>reducer (stateful) with retained props</li>
</ul>

<p>You can read the standard ReasonReact documentation to understand the
differences between them.</p>

<p>The methods and their parameters required for each component differ based on the
component type. The “self” parameter also contains slightly different content
based on the method being called. For example, in the unmount method, it does
not make sense to provide access to <code class="highlighter-rouge">onUnmount</code> method in self. If retained
props are used, <code class="highlighter-rouge">self</code> also contains those values.</p>

<p>If you are creating a reducer component you need to have methods:</p>

<ul>
  <li>initialState</li>
  <li>reducer</li>
</ul>

<p>in addition to the render method. All three are required and hence should be
declared with <code class="highlighter-rouge">val</code>:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">object</span> <span class="nc">MyComponent</span> <span class="o">{</span> 

  <span class="k">case</span> <span class="k">class</span> <span class="nc">State</span><span class="o">(...)</span>
  
  <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">Action</span>
  <span class="k">case</span> <span class="k">class</span> <span class="nc">ReducerAction1</span><span class="o">(</span><span class="n">arg</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
  <span class="k">case</span> <span class="k">class</span> <span class="nc">ReducerAction2</span><span class="o">(</span><span class="n">arg</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>  
  
  <span class="k">val</span> <span class="n">c</span> <span class="k">=</span> <span class="n">reducerComponent</span><span class="o">[</span><span class="kt">State</span>, <span class="kt">Action</span><span class="o">](</span><span class="s">"MyComponent"</span><span class="o">)</span>
  <span class="k">import</span> <span class="nn">c.ops._</span>
  
  <span class="k">def</span> <span class="n">make</span><span class="o">(</span><span class="n">arg</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> 
    <span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="k">new</span> <span class="n">methods</span> <span class="o">{</span> 
      <span class="k">val</span> <span class="n">initialState</span> <span class="k">=</span> <span class="n">self</span> <span class="k">=&gt;</span> <span class="nc">State</span><span class="o">()</span>
      <span class="k">val</span> <span class="n">reducer</span> <span class="k">=</span> <span class="o">(</span><span class="n">action</span><span class="o">,</span> <span class="n">state</span><span class="o">,</span> <span class="n">gen</span><span class="o">)</span> <span class="k">=&gt;</span>
          <span class="n">action</span> <span class="k">match</span> <span class="o">{</span> 
            <span class="k">case</span> <span class="nc">ReducerAction1</span><span class="o">(</span><span class="n">arg</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">gen</span><span class="o">.</span><span class="n">update</span><span class="o">(</span><span class="n">state</span><span class="o">.</span><span class="n">copy</span><span class="o">(...))</span>
            <span class="k">case</span> <span class="nc">ReducerAction2</span><span class="o">(</span><span class="n">arg</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">gen</span><span class="o">.</span><span class="n">effect</span><span class="o">(</span><span class="n">slf</span> <span class="k">=&gt;</span> <span class="n">print</span><span class="o">(</span><span class="s">"run a side effect with a self"</span><span class="o">))</span>
            <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="n">gen</span><span class="o">.</span><span class="n">skip</span> <span class="c1">// no state update
</span>          <span class="o">}</span>
      <span class="k">val</span> <span class="n">render</span> <span class="k">=</span> <span class="n">self</span> <span class="k">=&gt;</span> <span class="o">{</span>
         <span class="n">div</span><span class="o">()(</span><span class="s">"Some renderable content"</span><span class="o">)</span>
      <span class="o">}</span>
    <span class="o">})</span>
<span class="o">}</span>
</code></pre></div></div>

<p>You can also use SFC components with hooks. See the React Interop section for
information on hooks.</p>

<h2 id="attributes">Attributes</h2>

<p>You can define your make function to take either a list of attributes or an
object that bundles the attributes together. You can choose how you want to
define the make parameters.  In scala if you define your non-native JS traits
(you cannot instantiate a trait annotated with @js.native), then you can create
them without having to use “override val” syntax:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">trait</span> <span class="nc">MyOpts</span> <span class="k">extends</span> <span class="n">js</span><span class="o">.</span><span class="nc">Object</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">prop1</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">js</span><span class="o">.</span><span class="n">undefined</span>
  <span class="k">var</span> <span class="n">prop2</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">js</span><span class="o">.</span><span class="n">undefined</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Then you can do:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">new</span> <span class="nc">MyOpts</span> <span class="o">{</span> 
  <span class="n">prop1</span> <span class="k">=</span> <span class="s">"foo"</span><span class="o">,</span>
  <span class="n">prop2</span> <span class="k">=</span> <span class="s">"bar"</span>
<span class="o">}</span>
</code></pre></div></div>
<p>instead of:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">new</span> <span class="nc">MyOpts</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">val</span> <span class="n">prop1</span> <span class="k">=</span> <span class="s">"foo"</span>
  <span class="k">override</span> <span class="k">val</span> <span class="n">prop2</span> <span class="k">=</span> <span class="s">"bar"</span>
<span class="o">}</span>
</code></pre></div></div>

<p>In order to allow your props to contain other attributes, such as those from
div, just have your props inherit from the appropriate attributes trait that is
provided:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">trait</span> <span class="nc">MyOpts</span> <span class="k">extends</span> <span class="nc">HTMLAttributes</span><span class="o">[</span><span class="kt">dom.html.Div</span><span class="o">]</span> <span class="o">{</span>
   <span class="c1">// your extra traits
</span><span class="o">}</span>
</code></pre></div></div>

<p>You may need to filter your props so you can access only your attributes. See
office-ui-fabric-react for an example of a function that can do that
filtering. There are many approaches to supporting this.</p>

<h2 id="child-elements">Child Elements</h2>

<p>Children in scalajs-react are ReactNode or ReactElement (subclass of
ReactNode). Whatever you do, you need to take your imported react components,
your scalajs-react components and convert them to a ReactNode in order to use
them as children in other scalajs-react components. You have a few ways of doing
this.</p>

<ul>
  <li>Explicitly using the API: <code class="highlighter-rouge">createElement(YourComponentC.make(...))</code></li>
  <li>Using syntax: <code class="highlighter-rouge">YourComponentC.make(..).toEl</code>.</li>
  <li>Implicit conversions: <code class="highlighter-rouge">YourComponentC.make(...)</code></li>
</ul>

<p>Note that every child must be converted to a <code class="highlighter-rouge">ReactNode</code> type, including strings
and numbers. There are some functions for doing that:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">stringElement</span> <span class="k">=</span> <span class="n">stringToElement</span><span class="o">(</span><span class="s">"blah"</span><span class="o">)</span>
</code></pre></div></div>

<p>which can be quite verbose, hence the implicit conversions which will a wide
range of simple types to a <code class="highlighter-rouge">ReactNode</code> automatically.</p>

<h2 id="whats-ops">What’s Ops?</h2>

<p>The import <code class="highlighter-rouge">c.ops._</code> imports the “methods” trait so you can customize the
component for your specific render, reducer, and processing needs. It also
contains a few types you can use to help you break out methods into small
parts. For example, it contains the “Self” type so that you can define a
function separate from the methods:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="n">renderFooter</span><span class="o">(</span><span class="n">self</span><span class="k">:</span> <span class="kt">Self</span><span class="o">,</span> <span class="o">...)</span><span class="k">:</span> <span class="kt">ReactNode</span> <span class="o">=</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
</code></pre></div></div>

<p>If you use state or retained props, it contains <code class="highlighter-rouge">S</code> and <code class="highlighter-rouge">RP</code> as well. Generally
though you should not pass self around but the specific arguments you need to
perform the rendering.</p>

<p>The types from a component will <em>not</em> work anywhere else but for that
component. The “Self” type is tied to the component as a dependent type. Another
component will have another “Self” type…you cannot inappropriately mix things
up. If you have common processing in your function call that takes a “Self”
merely pass in the parts of “Self” that are needed and factor out the common
processing.</p>

<p>When you create a component, you indicate whether it takes retainded props or
initial state. You are forced to create those when you perform the copy by
having to use a “val” in your “methods” definitions. Optional parameters can be
specified just using “name=value”. Functions have to be wrapped in “js.defined”
due to some scala.js needs for type resolution but the initial state or retained
prop values do not need that:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">MyState</span><span class="o">(...)</span>
<span class="k">sealed</span> <span class="k">trait</span> <span class="nc">Action</span>
<span class="k">val</span> <span class="n">c</span> <span class="k">=</span> <span class="n">reducerComponent</span><span class="o">[</span><span class="kt">MyState</span>, <span class="kt">Action</span><span class="o">](</span><span class="s">"component"</span><span class="o">)</span>
<span class="k">import</span> <span class="nn">c.ops._</span>

<span class="k">def</span> <span class="n">make</span><span class="o">(...)</span> <span class="k">=</span> <span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="k">new</span> <span class="n">methods</span> <span class="o">{</span>
    <span class="c1">// stateful component so you *must* define initialState
</span>    <span class="k">val</span> <span class="n">initialState</span> <span class="k">=</span> <span class="n">self</span> <span class="k">=&gt;</span> <span class="nc">MyState</span><span class="o">()</span>
    <span class="c1">// render and most everything else is optional, default render returns null
</span>    <span class="k">val</span> <span class="n">render</span> <span class="k">=</span> <span class="n">self</span> <span class="k">=&gt;</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
    <span class="k">val</span> <span class="n">reducer</span> <span class="k">=</span> <span class="o">(</span><span class="n">action</span><span class="o">,</span> <span class="n">state</span><span class="o">,</span> <span class="n">gen</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span> <span class="o">...</span> <span class="cm">/* return a reducer result */</span> <span class="o">}</span>
<span class="o">})</span>

</code></pre></div></div>

<h2 id="implementation-note">Implementation Note</h2>

<p>The object returned from “statelessComponent” is actually not the actually
javascript proxy or the scala side component (ComponentSpec, which is a
non-native JS trait). The returned value is a “cake” since the proxy and the
component are created in a cake. To obtain the actual scala side component, use
<code class="highlighter-rouge">myComponentCake.component</code>. Each cake allocates a proxy and component which
amount to two javascript objects. If you wish to change the internals, you can
reformulate the cake and re-use the different parts with a fairly high degree of
reuse. In a sense, the cake employs the “factory” and “builder” design patterns
when you write your “make” function.</p>

<p>The API is designed so that you don’t need to know the representation of any
part of the API other than you use <code class="highlighter-rouge">.copy(new methods { ...})</code> in your make
function. The provided “ops.copy” function copies the scala side component and
adds your methods to customize its behavior. The copy and merge processing has
the same complexity of using javascript’s <code class="highlighter-rouge">Object.assign</code> method–so its
efficient. The current API, with an emphasis on opaqueness, allows us to
completely change the underlying implementation if need be. reason-react
documents that they use the OCAML record format which maps to a javascript array
and they use that explicitly in their API.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/scalajs-reaction/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script src="/scalajs-reaction/js/main.js"></script></body></html>