<html><head><title>scalajs-reaction: Exporting Components to Javascript</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="aappddeevv" /><meta name="description" content="A react integration library for scala.js in the spirit of ReasonReact" /><meta name="og:image" content="/scalajs-reaction/img/poster.png" /><meta name="og:title" content="scalajs-reaction: Exporting Components to Javascript" /><meta name="og:site_name" content="scalajs-reaction" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="A react integration library for scala.js in the spirit of ReasonReact" /><link rel="icon" type="image/png" href="/scalajs-reaction/img/favicon.png" /><meta name="twitter:title" content="scalajs-reaction: Exporting Components to Javascript" /><meta name="twitter:image" content="img/poster.png" /><meta name="twitter:description" content="A react integration library for scala.js in the spirit of ReasonReact" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/scalajs-reaction/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/scalajs-reaction/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/scalajs-reaction/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/scalajs-reaction/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/scalajs-reaction/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/scalajs-reaction/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/scalajs-reaction/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/scalajs-reaction/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/scalajs-reaction/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/scalajs-reaction/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/scalajs-reaction/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/scalajs-reaction/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/scalajs-reaction/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/scalajs-reaction/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/scalajs-reaction/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/scalajs-reaction/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/scalajs-reaction/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/scalajs-reaction/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/scalajs-reaction/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/scalajs-reaction/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/scalajs-reaction/highlight/styles/default.css" /><link rel="stylesheet" href="/scalajs-reaction/css/style.css" /><link rel="stylesheet" href="/scalajs-reaction/css/palette.css" /><link rel="stylesheet" href="/scalajs-reaction/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/scalajs-reaction/" class="brand"><div class="brand-wrapper"><span>scalajs-reaction</span></div></a></li> <li><a href="/scalajs-reaction/docs/index.html" class="">Getting Started</a></li> <li><a href="/scalajs-reaction/docs/creating.html" class="">Defining Components</a></li> <li><a href="/scalajs-reaction/docs/importing.html" class="">Importing from JS</a></li> <li><a href="/scalajs-reaction/docs/exporting.html" class="">Exporting to JS</a></li> <li><a href="/scalajs-reaction/docs/styling.html" class="">Styling Suggestions</a></li> <li><a href="/scalajs-reaction/docs/vdom.html" class="">Virtual DOM</a></li> <li><a href="/scalajs-reaction/docs/router.html" class="">Routing</a></li> <li><a href="/scalajs-reaction/docs/bundling.html" class="">Bundling</a></li> <li><a href="/scalajs-reaction/docs/redux.html" class="">Redux</a></li> <li><a href="/scalajs-reaction/docs/datainterop.html" class="">Data interop</a></li> <li><a href="/scalajs-reaction/docs/facades.html" class="">Widget Facades</a></li> <li><a href="/scalajs-reaction/docs/mixedproject.html" class="">Mixed Projects</a></li> <li><a href="/scalajs-reaction/docs/reactinterop.html" class="">React Interop</a></li> <li><a href="/scalajs-reaction/docs/data-validation.html" class="">Data Validation</a></li> <li><a href="/scalajs-reaction/docs/forms.html" class="">Forms</a></li> <li><a href="/scalajs-reaction/docs/native.html" class="">React Native</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/aappddeevv/scalajs-reaction"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/aappddeevv/scalajs-reaction"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('scalajs-reaction A react integration library for scala.js in the spirit of ReasonReact');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('scalajs-reaction A react integration library for scala.js in the spirit of ReasonReact');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="aappddeevv" data-github-repo="scalajs-reaction"><div class="content-wrapper"><section><h1 id="exporting">Exporting</h1>

<p>Exporting a component for use in javascript environments requires you to map the
props interface in scalajs-react to javascript. By providing a function like
<code class="highlighter-rouge">jsProps: js.Object =&gt; Component</code>, you can map your components.</p>

<p>The interface to export your component is actually quite simple although you can
create your own “mapping” framework if you want to make your mapping process
easier. For example, you could create a set of “Write” typeclasses.</p>

<p>Here’s the API. This is all you need to do:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ToDoProp is a non-native JS trait
</span><span class="nd">@JSExportTopLevel</span><span class="o">(</span><span class="s">"ToDo"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">exportedToDo</span> <span class="k">=</span> <span class="nc">ToDo</span><span class="o">.</span><span class="n">wrapScalaForJs</span><span class="o">((</span><span class="n">jsProps</span><span class="k">:</span> <span class="kt">ToDoProps</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">make</span><span class="o">(</span><span class="n">jsProps</span><span class="o">))</span>
</code></pre></div></div>

<p>We mentioned in the previous section that if your make/apply parameter object is
javascript friendly, such as ToDoProps, it’s easier to interface. In fact, if
you do it this waya and there is no other processing you need to perform on the properties, you can shrink the above to:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ToDoProp is a non-native JS trait
</span><span class="nd">@JSExportTopLevel</span><span class="o">(</span><span class="s">"ToDo"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">exportedToDo</span> <span class="k">=</span> <span class="nc">ToDo</span><span class="o">.</span><span class="n">wrapScalaForJs</span><span class="o">(</span><span class="n">make</span><span class="o">(</span><span class="k">_</span><span class="o">))</span>
</code></pre></div></div>

<p>The type return is <code class="highlighter-rouge">ReactJsComponent</code> which is the same type you use for
importing. Importing is described in the next section.</p>

<p>Note that when you export at the top level using <code class="highlighter-rouge">@JSExportTopLevel</code>, your
export is at the module level and depending on your javascript bundler, it is
accessible just like any other export you may create in a javascript module.</p>

<p>If you have logic that needs to run to convert the props, just put them in the
wrap function:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@JSExportTopLevel</span><span class="o">(</span><span class="s">"ToDo"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">exportedToDo</span> <span class="k">=</span> <span class="nc">ToDo</span><span class="o">.</span><span class="n">wrapScalaForJs</span><span class="o">{(</span><span class="n">jsProps</span><span class="k">:</span> <span class="kt">ToDoProps</span><span class="o">)</span> <span class="k">=&gt;</span> 
    <span class="c1">// conversion logic
</span>    <span class="k">val</span> <span class="n">prop1</span> <span class="k">=</span> <span class="n">convert1</span><span class="o">(</span><span class="n">jsProps</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">prop2</span> <span class="k">=</span> <span class="n">convert2</span><span class="o">(</span><span class="n">jsProps</span><span class="o">)</span>
    <span class="c1">// this component's "make" takes 2 arguments broken out
</span>    <span class="n">make</span><span class="o">(</span><span class="n">prop1</span><span class="o">,</span> <span class="n">prop2</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="exporting-from-scalajs-and-javascript-bundling">Exporting from scala.js and javascript bundling</h2>

<p>If you had setup your Component to take a js.Object derived trait/class as the
only argument, then you could use that for <code class="highlighter-rouge">jsProps</code>’s type as shown in the
first example above. Or, if your component has multiple input parameters, then
your mapping function must take a js.Object and break out the values and call
<code class="highlighter-rouge">make</code> as appropriate.</p>

<p>When you bundle, say using webpack, your <code class="highlighter-rouge">ToDo</code> will be available at the name
<code class="highlighter-rouge">WebPackLibName.ToDo</code> because ToDo was exported at the module level and webpack
bundles all modules together and manipulates those exports. You could, as
indicated in the scala.js documentation, use an export name that has multiple
levels in it to help separate out your scalajs-react components into groups:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@JSExportTopLevel</span><span class="o">(</span><span class="s">"PIM"</span><span class="o">)</span>
<span class="k">object</span> <span class="nc">PIM</span> <span class="k">extends</span> <span class="n">js</span><span class="o">.</span><span class="nc">Object</span>
  <span class="nd">@JSExport</span><span class="o">(</span><span class="s">"ToDo"</span><span class="o">)</span>
  <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>in which case you would access it in javascript via
<code class="highlighter-rouge">WebPackLibName.PIM.ToDo</code>. This is standard scala.js export syntax.</p>

<p>If you want to use typescript as your “javascript” language for
external-to-scala.js components, you will need to reproduce your typescript
definitions for the parameters manually. Or you could write them in typescript
and translate them into scala.js :-). It’s up to you.</p>

<h2 id="you-can-get-fancy-but-its-probably-not-worth-it">You Can Get Fancy But It’s Probably Not Worth It</h2>

<p>If you create your own typeclass system you could:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">trait</span> <span class="nc">Writer</span><span class="o">[</span><span class="kt">A</span> <span class="k">&lt;:</span> <span class="kt">js.Object</span><span class="o">]</span> <span class="o">{</span>
   <span class="k">def</span> <span class="n">toJs</span><span class="o">(</span><span class="n">props</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span><span class="k">:</span> <span class="kt">Component</span><span class="o">[</span><span class="k">_</span>,<span class="k">_</span>,<span class="k">_</span>,<span class="k">_</span><span class="o">]</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">MyExporter</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">myExporter</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">component</span><span class="k">:</span> <span class="kt">Component</span><span class="o">[</span><span class="k">_</span>,<span class="k">_</span>,<span class="k">_</span>,<span class="k">_</span><span class="o">])(</span><span class="k">implicit</span> <span class="n">writer</span><span class="k">:</span> <span class="kt">Writer</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span> <span class="k">=</span> 
     <span class="n">component</span><span class="o">.</span><span class="n">wrapScalaForJs</span><span class="o">(</span><span class="n">component</span><span class="o">,</span> <span class="n">writer</span><span class="o">.</span><span class="n">toJs</span> <span class="k">_</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The reason it may not be worth it to be too fancy is that the conversion between
props is not shared between components. If something in your props is common
across scala components, then you can create a function to convert that part of
the data.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/scalajs-reaction/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script src="/scalajs-reaction/js/main.js"></script></body></html>